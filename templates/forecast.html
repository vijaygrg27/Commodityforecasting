{% extends 'base.html' %}

{% block body %}






<div id="layoutSidenav_content">
    <main>
        <div class="container-fluid px-4">
            <h2 class="u-align-center u-custom-font u-font-lobster u-text u-text-default u-text-1">Commodity Forecast</h2>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"></script>

        <script type="text/javascript">
            var pricechart = {{ price  | safe }}
            Plotly.plot('price', pricechart, {});
        </script>
        <script>
            let state_select = document.getElementById('state');
            let district_select = document.getElementById('district');
            let market_select = document.getElementById('market');
            let commodity_select = document.getElementById('commodity');
            let variety_select = document.getElementById('variety');

            state_select.onchange = function () {
                state = state_select.value;

                fetch('/district/' + state).then(function (response) {
                    response.json().then(function (data) {
                        let optionHTML = '<option value = "Select option" selected disabled hidden> Select District </option>';
                        for (let district of data.districtArray) {
                            optionHTML += '<option value = "' + district + '">' + district + '</option>';

                        }

                        district_select.innerHTML = optionHTML;
                    });
                });
            }


            district_select.onchange = function () {
                district = district_select.value;

                fetch('/market/' + district).then(function (response) {
                    response.json().then(function (data) {
                        let optionHTML = '<option value = "Select option" selected disabled hidden> Select Market </option>';
                        for (let market of data.marketArray) {
                            optionHTML += '<option value = "' + market + '">' + market + '</option>';

                        }

                        market_select.innerHTML = optionHTML;
                    });
                });
            }



            market_select.onchange = function () {
                market = market_select.value;

                fetch('/commodity/' + market).then(function (response) {
                    response.json().then(function (data) {
                        let optionHTML = '<option value = "Select option" selected disabled hidden> Select Commodity </option>';
                        for (let commodity of data.commodityArray) {
                            optionHTML += '<option value = "' + commodity + '">' + commodity + '</option>';

                        }

                        commodity_select.innerHTML = optionHTML;
                    });
                });
            }


            commodity_select.onchange = function () {
                commodity = commodity_select.value;

                fetch('/variety/' + commodity).then(function (response) {
                    response.json().then(function (data) {
                        let optionHTML = '<option value = "Select option" selected disabled hidden> Select Variety </option>';
                        for (let variety of data.varietyArray) {
                            optionHTML += '<option value = "' + variety + '">' + variety + '</option>';

                        }

                        variety_select.innerHTML = optionHTML;
                    });
                });
            }

        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
    <script src="static/js/scripts.js"></script>
    <script type="text/javascript">
        $('#proxies').DataTable();
    </script>
    </div>
    {% endblock body %}